開発フロー:
コミット → Unit Test (数秒)
↓
PR 作成 → Integration Test (数十秒〜数分)
↓
マージ → E2E Test (数分〜十数分)
↓
デプロイ → 本番監視

| テスト種別      | DB         | 外部 API | 認証                       | 速度       | 実行タイミング      | 目的               |
| --------------- | ---------- | -------- | -------------------------- | ---------- | ------------------- | ------------------ |
| **Unit**        | モック     | モック   | なし                       | 超高速(秒) | コミット毎          | ロジックの正しさ   |
| **Integration** | Test DB    | モック   | モックトークン             | 高速(分)   | PR 毎               | 機能の連携確認     |
| **E2E**         | Staging DB | Sandbox  | 認証状態保存 or バックドア | 低速(分)   | マージ後/デプロイ前 | ユーザー体験の確認 |

# 実行タイミングはこちらでも

| テスト種別      | 実行タイミング            | 理由                                   |
| --------------- | ------------------------- | -------------------------------------- |
| **Unit**        | コミット毎（PR 作成時）   | 超高速なので毎回実行しても OK          |
| **Integration** | **PR マージ後**           | やや遅いのでマージ済みコードのみテスト |
| **E2E**         | **main/develop マージ後** | 最も遅いので重要なブランチのみ         |

```

| テスト種別 | スコープ | 例 |
|-----------|---------|-----|
| **Integration** | **1つのサービス内の複数コンポーネント** | API + DB + 外部APIモック |
| **E2E** | **複数のサービス間の連携** | Frontend + Backend + DB + 外部サービス |

### 修正版 CI/CD フロー
```

開発者がコミット
↓
PR 作成
↓
Unit Test 実行（数秒） ← 通らないとレビュー不可
↓
コードレビュー
↓
PR 承認 & マージ
↓
Integration Test 実行（数分） ← マージ後に実行
↓ (失敗したらロールバック)
main/develop へマージ
↓
E2E Test 実行（数分〜十数分） ← 主要ブランチのみ
↓ (失敗したらデプロイ中止)
デプロイ
